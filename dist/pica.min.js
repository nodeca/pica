/* pica 1.1.1 nodeca/pica */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r;r="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,r.pica=e()}}(function(){return function e(r,n,t){function a(o,u){if(!n[o]){if(!r[o]){var f="function"==typeof require&&require;if(!u&&f)return f(o,!0);if(i)return i(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var c=n[o]={exports:{}};r[o][0].call(c.exports,function(e){var n=r[o][1][e];return a(n?n:e)},c,c.exports,e,r,n,t)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<t.length;o++)a(t[o]);return a}({1:[function(e,r,n){"use strict";function t(e){return 0>e?0:e>255?255:e}function a(e){return Math.floor(e*d)}function i(e,r,n){var t,i,o,u,f,s,c,l,d,v,p,g,E,m,_,T,R,w=h[e].filter,x=n/r,b=1/x,A=Math.min(1,x),y=h[e].win/A,F=Math.floor(2*(y+1)),M=new Int16Array((F+2)*n),U=0;for(t=0;n>t;t++){for(i=(t+.5)*b,o=Math.max(0,Math.floor(i-y)),u=Math.min(r-1,Math.ceil(i+y)),f=u-o+1,s=new Float32Array(f),c=new Int16Array(f),l=0,v=o,p=0;u>=v;v++,p++)g=w((v+.5-i)*A),l+=g,s[p]=g;for(d=0,p=0;p<s.length;p++)E=a(s[p]/l),d+=E,c[p]=E;for(c[n>>1]+=a(1)-d,m=0;m<c.length&&0===c[m];)m++;if(m<c.length){for(_=c.length-1;_>0&&0===c[_];)_--;T=o+m,R=_-m+1,M[U++]=T,M[U++]=R,M.set(c.subarray(m,_+1),U),U+=R}else M[U++]=0,M[U++]=0}return M}function o(e,r,n,a,i,o){var u,f,s,c,l,d,h,v,p,g,E,m=0,_=0;for(p=0;a>p;p++){for(l=0,g=0;i>g;g++){for(d=o[l++],h=o[l++],v=m+4*d|0,u=f=s=c=0;h>0;h--)E=o[l++],c=c+E*e[v+3]|0,s=s+E*e[v+2]|0,f=f+E*e[v+1]|0,u=u+E*e[v]|0,v=v+4|0;r[_+3]=t(c+8192>>14),r[_+2]=t(s+8192>>14),r[_+1]=t(f+8192>>14),r[_]=t(u+8192>>14),_=_+4*a|0}_=4*(p+1)|0,m=(p+1)*n*4|0}}function u(e,r,n,a,i,o){var u,f,s,c,l,d,h,v,p,g,E,m=0,_=0;for(p=0;a>p;p++){for(l=0,g=0;i>g;g++){for(d=o[l++],h=o[l++],v=m+4*d|0,u=f=s=c=0;h>0;h--)E=o[l++],c=c+E*e[v+3]|0,s=s+E*e[v+2]|0,f=f+E*e[v+1]|0,u=u+E*e[v]|0,v=v+4|0;r[_+3]=t(c+8192>>14),r[_+2]=t(s+8192>>14),r[_+1]=t(f+8192>>14),r[_]=t(u+8192>>14),_=_+4*a|0}_=4*(p+1)|0,m=(p+1)*n*4|0}}function f(e,r,n){for(var t=3,a=r*n*4|0;a>t;)e[t]=255,t=t+4|0}function s(e){var r=e.src,n=e.width,t=e.height,a=e.toWidth,s=e.toHeight,l=e.dest||new Uint8Array(a*s*4),d="undefined"==typeof e.quality?3:e.quality,h=e.alpha||!1,v="undefined"==typeof e.unsharpAmount?0:0|e.unsharpAmount,p="undefined"==typeof e.unsharpRadius?0:e.unsharpRadius,g="undefined"==typeof e.unsharpThreshold?0:0|e.unsharpThreshold;if(1>n||1>t||1>a||1>s)return[];var E=i(d,n,a),m=i(d,t,s),_=new Uint8Array(a*t*4);return o(r,_,n,t,a,E),u(_,l,t,a,s,m),h||f(l,a,s),v&&c(l,a,s,v,p,g),l}var c=e("./unsharp"),l=14,d=1<<l,h=[{win:.5,filter:function(e){return e>=-.5&&.5>e?1:0}},{win:1,filter:function(e){if(-1>=e||e>=1)return 0;if(e>-1.1920929e-7&&1.1920929e-7>e)return 1;var r=e*Math.PI;return Math.sin(r)/r*(.54+.46*Math.cos(r/1))}},{win:2,filter:function(e){if(-2>=e||e>=2)return 0;if(e>-1.1920929e-7&&1.1920929e-7>e)return 1;var r=e*Math.PI;return Math.sin(r)/r*Math.sin(r/2)/(r/2)}},{win:3,filter:function(e){if(-3>=e||e>=3)return 0;if(e>-1.1920929e-7&&1.1920929e-7>e)return 1;var r=e*Math.PI;return Math.sin(r)/r*Math.sin(r/3)/(r/3)}}];r.exports=s},{"./unsharp":2}],2:[function(e,r,n){"use strict";function t(e,r,n){for(var t,a,i,o,u,f=r*n,s=new Uint16Array(f),c=0;f>c;c++)t=e[4*c],a=e[4*c+1],i=e[4*c+2],u=t>=a&&t>=i?t:a>=i&&a>=t?a:i,o=a>=t&&i>=t?t:i>=a&&t>=a?a:i,s[c]=257*(u+o)>>1;return s}function a(e,r,n,a,o,u){var f,s,c,l,d,h,v,p,g,E,m,_,T;if(!(0===a||.5>o)){var R=t(e,r,n),w=new Uint16Array(R);i(w,r,n,o);for(var x=a/100*4096+.5|0,b=257*u|0,A=r*n,y=0;A>y;y++)_=2*(R[y]-w[y]),Math.abs(_)>=b&&(T=4*y,f=e[T],s=e[T+1],c=e[T+2],p=f>=s&&f>=c?f:s>=f&&s>=c?s:c,v=s>=f&&c>=f?f:f>=s&&c>=s?s:c,h=257*(p+v)>>1,v===p?l=d=0:(d=32767>=h?4095*(p-v)/(p+v)|0:4095*(p-v)/(510-p-v)|0,l=f===p?65535*(s-c)/(6*(p-v))|0:s===p?21845+(65535*(c-f)/(6*(p-v))|0):43690+(65535*(f-s)/(6*(p-v))|0)),h+=x*_+2048>>12,h>65535?h=65535:0>h&&(h=0),0===d?f=s=c=h>>8:(E=32767>=h?h*(4096+d)+2048>>12:h+((65535-h)*d+2048>>12),g=2*h-E>>8,E>>=8,m=l+21845&65535,f=m>=43690?g:m>=32767?g+(6*(E-g)*(43690-m)+32768>>16):m>=10922?E:g+(6*(E-g)*m+32768>>16),m=65535&l,s=m>=43690?g:m>=32767?g+(6*(E-g)*(43690-m)+32768>>16):m>=10922?E:g+(6*(E-g)*m+32768>>16),m=l-21845&65535,c=m>=43690?g:m>=32767?g+(6*(E-g)*(43690-m)+32768>>16):m>=10922?E:g+(6*(E-g)*m+32768>>16)),e[T]=f,e[T+1]=s,e[T+2]=c)}}var i=e("glur/mono16");r.exports=a,r.exports.lightness=t},{"glur/mono16":6}],3:[function(e,r,n){"use strict";var t=e("./pure/resize");r.exports=function(e,r){var n=t(e);r(null,n)}},{"./pure/resize":1}],4:[function(e,r,n){"use strict";function t(e){try{(window.console.error||window.console.log).call(window.console,e)}catch(r){}}function a(e){var r=e.getError();if(r!==e.NO_ERROR)throw new Error("gl error "+r)}function i(e){return e.getContext("webgl")||e.getContext("experimental-webgl")}function o(e,r,n){var a=e.createShader(r);return e.shaderSource(a,n),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)?a:(t("Shader compile error: "+e.getShaderInfoLog(a)+". Source: `"+n+"`"),e.deleteShader(a),null)}function u(e,r,n){var i=o(e,e.VERTEX_SHADER,m[r]),u=o(e,e.FRAGMENT_SHADER,m[n]),f=e.createProgram();return e.attachShader(f,i),e.attachShader(f,u),e.linkProgram(f),e.getProgramParameter(f,e.LINK_STATUS)||(t("Program linking error: "+e.getProgramInfoLog(f)),e.deleteProgram(f)),a(e),f}function f(e,r,n,t,i){var o=e.getAttribLocation(r,n);e.bindBuffer(e.ARRAY_BUFFER,e.createBuffer()),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t),e.STATIC_DRAW),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,i.elementSize,e.FLOAT,!1,0,0),a(e)}function s(e,r,n){var t=e.createTexture();return e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),a(e),t}function c(e,r,n,t){var a=e.getUniformLocation(r,n);e.uniform1i(a,t)}function l(e,r,n,t,a){var i=e.getUniformLocation(r,n);e.uniform2f(i,t,a)}function d(e,r,n,t){var a=e,i=e+n,o=r,u=r+t;return[a,o,i,o,a,u,a,u,i,o,i,u]}function h(e,r,n,t){var i=e.createTexture();return e.activeTexture(e.TEXTURE0+r),e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n,t,0,e.RGBA,e.UNSIGNED_BYTE,null),a(e),i}function v(e,r,n,t){var i=h(e,r,n,t),o=e.getParameter(e.FRAMEBUFFER_BINDING),u=e.createFramebuffer();return e.bindFramebuffer(e.FRAMEBUFFER,u),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),a(e),{fbo:u,texture:i,oldFbo:o}}function p(e,r,n,t,i,o,s,h,p){var g=u(e,"#vsh-basic",o);e.useProgram(g),c(e,g,"u_image",r),l(e,g,"u_imageSize",n,t),l(e,g,"u_resolution",s,h),f(e,g,"a_texCoord",[0,0,1,0,0,1,0,1,1,0,1,1],{elementSize:2}),f(e,g,"a_position",p?d(0,h,s,-h):d(0,0,s,h),{elementSize:2}),e.viewport(0,0,s,h);var E=v(e,i,s,h);return e.viewport(0,0,s,h),e.drawArrays(e.TRIANGLES,0,6),e.bindFramebuffer(e.FRAMEBUFFER,E.oldFbo),a(e),E}function g(e,r,n){var t=e.width,a=e.height,i=r.canvas.width,o=r.canvas.height;r.viewport(0,0,i,o);var u=0;s(r,u,e);var f=2,c=3;p(r,u,t,a,f,"#fsh-lanczos-1d-covolve-horizontal",i,a,!1);var l=p(r,f,i,a,c,"#fsh-lanczos-1d-covolve-vertical",i,o,!0);r.flush();var d=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,d),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,l.texture,0);var h=r.checkFramebufferStatus(r.FRAMEBUFFER);if(h!==r.FRAMEBUFFER_COMPLETE)throw new Error("Bad framebuffer status: "+h);n.alpha||(r.clearColor(1,1,1,1),r.colorMask(!1,!1,!1,!0),r.clear(r.COLOR_BUFFER_BIT));var v=new Uint8Array(i*o*4);r.readPixels(0,0,i,o,r.RGBA,r.UNSIGNED_BYTE,v);var g="undefined"==typeof n.unsharpAmount?0:0|n.unsharpAmount,m="undefined"==typeof n.unsharpRadius?0:n.unsharpRadius,_="undefined"==typeof n.unsharpThreshold?0:0|n.unsharpThreshold;return g&&E(v,i,o,g,m,_),v}var E=e("./pure/unsharp"),m={};m["#vsh-basic"]="precision highp float;\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform vec2 u_resolution;\n\nvarying vec2 v_texCoord;\n\nvoid main() {\n   vec2 clipSpace = a_position / u_resolution * 2.0 - 1.0;\n\n   gl_Position = vec4(clipSpace, 0, 1);\n   v_texCoord = a_texCoord;\n}\n",m["#fsh-lanczos-1d-covolve-horizontal"]="precision highp float;\nuniform vec2 u_resolution;\nuniform sampler2D u_image;\nuniform vec2 u_imageSize;\n\n#define winSize 3.0\n\nvarying vec2 v_texCoord;\n\n#define sinc(a) (sin(a)/a)\n#define M_PI 3.1415926535897932384626433832795\n\nvoid main() {\n  vec2 pixel = vec2(1.) / u_imageSize;\n  gl_FragColor = vec4(0.);\n\n  float total = 0.;\n  float scale = u_imageSize.x / u_resolution.x;\n  float count = winSize * scale * 2.;\n  for (int i = 0; i < 1024*8; i++) {\n    if (float(i) >= count) {\n      break;\n    }\n    float k = float(i) - (count / 2.);\n    vec2 offset = vec2(pixel.x * k, 0.);\n    vec4 c = texture2D(u_image, v_texCoord+offset);\n    float x = k / scale; // max [-3, 3]\n    float xpi = x * M_PI;\n    float b = sinc(xpi) * sinc(xpi / winSize);\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) { \n      b = 1.;\n    }\n    total += b;\n    c *= vec4(b);\n    gl_FragColor += c;\n  }\n  gl_FragColor /= vec4(total);\n}\n",m["#fsh-lanczos-1d-covolve-vertical"]="precision highp float;\nuniform vec2 u_resolution;\nuniform sampler2D u_image;\nuniform vec2 u_imageSize;\n\n#define winSize 3.0\n\nvarying vec2 v_texCoord;\n\n#define sinc(a) (sin(a)/a)\n#define M_PI 3.1415926535897932384626433832795\n\nvoid main() {\n  vec2 pixel = vec2(1.) / u_imageSize;\n  gl_FragColor = vec4(0.);\n\n  float total = 0.;\n  float scale = u_imageSize.y / u_resolution.y;\n  float count = winSize * scale * 2.;\n  for (int i = 0; i < 1024*8; i++) {\n    if (float(i) >= count) {\n      break;\n    }\n    float k = float(i) - (count / 2.);\n    vec2 offset = vec2(0., pixel.y * k);\n    vec4 c = texture2D(u_image, v_texCoord+offset);\n    float x = k / scale; // max [-3, 3]\n    float xpi = x * M_PI;\n    float b = sinc(xpi) * sinc(xpi / winSize);\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) { \n      b = 1.;\n    }\n    total += b;\n    c *= vec4(b);\n    gl_FragColor += c;\n  }\n  gl_FragColor /= vec4(total);\n}\n",r.exports=function(e,r,n,a){var o,u;try{u=document.createElement("canvas"),u.id="pica-webgl-temporarry-canvas",u.height=r.height,u.width=r.width,document.body.appendChild(u),o=i(u);var f=g(e,o,n);o.finish(),document.body.removeChild(u);var s=r.getContext("2d"),c=s.createImageData(r.width,r.height);c.data.set(f),s.putImageData(c,0,0),a(null,f)}catch(l){t(l),o.finish(),document.body.removeChild(u),a(l)}return null}},{"./pure/unsharp":2}],5:[function(e,r,n){"use strict";r.exports=function(r){var n=e("./resize");r.onmessage=function(e){n(e.data,function(e,n){return e?void r.postMessage({err:e}):void r.postMessage({output:n},[n.buffer])})}}},{"./resize":3}],6:[function(e,r,n){function t(e){.5>e&&(e=.5);var r=Math.exp(.527076)/e,n=Math.exp(-r),t=Math.exp(-2*r),a=(1-n)*(1-n)/(1+2*r*n-t);return o=a,u=a*(r-1)*n,f=a*(r+1)*n,s=-a*t,c=2*n,l=-t,d=(o+u)/(1-c-l),h=(f+s)/(1-c-l),new Float32Array([o,u,f,s,c,l,d,h])}function a(e,r,n,t,a,i){var o,u,f,s,c,l,d,h,v,p,g,E,m,_;for(v=0;i>v;v++){for(l=v*a,d=v,h=0,o=e[l],c=o*t[6],s=c,g=t[0],E=t[1],m=t[4],_=t[5],p=0;a>p;p++)u=e[l],f=u*g+o*E+s*m+c*_,c=s,s=f,o=u,n[h]=s,h++,l++;for(l--,h--,d+=i*(a-1),o=e[l],c=o*t[7],s=c,u=o,g=t[2],E=t[3],p=a-1;p>=0;p--)f=u*g+o*E+s*m+c*_,c=s,s=f,o=u,u=e[l],r[d]=n[h]+s,l--,h--,d-=i}}function i(e,r,n,i){if(i){var o=new Uint16Array(e.length),u=new Float32Array(Math.max(r,n)),f=t(i);a(e,o,u,f,r,n,i),a(o,e,u,f,n,r,i)}}var o,u,f,s,c,l,d,h;r.exports=i},{}],7:[function(e,r,n){var t=arguments[3],a=arguments[4],i=arguments[5],o=JSON.stringify;r.exports=function(e){for(var r,n=Object.keys(i),u=0,f=n.length;f>u;u++){var s=n[u];if(i[s].exports===e){r=s;break}}if(!r){r=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var c={},u=0,f=n.length;f>u;u++){var s=n[u];c[s]=s}a[r]=[Function(["require","module","exports"],"("+e+")(self)"),c]}var l=Math.floor(Math.pow(16,8)*Math.random()).toString(16),d={};d[r]=r,a[l]=[Function(["require"],"require("+o(r)+")(self)"),d];var h="("+t+")({"+Object.keys(a).map(function(e){return o(e)+":["+a[e][0]+","+o(a[e][1])+"]"}).join(",")+"},{},["+o(l)+"])",v=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(v.createObjectURL(new Blob([h],{type:"text/javascript"})))}},{}],"/":[function(e,r,n){"use strict";function t(e){return Object.prototype.toString.call(e)}function a(e){return"[object Function]"===t(e)}function i(r,t){var a,i={src:r.src,dest:null,width:0|r.width,height:0|r.height,toWidth:0|r.toWidth,toHeight:0|r.toHeight,quality:r.quality,alpha:r.alpha,unsharpAmount:r.unsharpAmount,unsharpRadius:r.unsharpRadius,unsharpThreshold:r.unsharpThreshold};return u||(n.WW=!1),u&&n.WW?(n.debug("Resize buffer in WebWorker"),a=e("webworkify")(h),a.onmessage=function(e){var n,i,o=r.dest,u=e.data.output;if(o)if(o.set)o.set(u);else for(n=0,i=u.length;i>n;n++)o[n]=u[n];t(e.data.err,u),a.terminate()},r.transferable?a.postMessage(i,[r.src.buffer]):a.postMessage(i),a):(n.debug("Resize buffer sync (freeze event loop)"),i.dest=r.dest,d(i,t),null)}function o(e,r,t,u){var f,s,c=e.width,d=e.height,h=r.width,p=r.height;if(a(t)&&(u=t,t={}),isNaN(t)||(t={quality:t,alpha:!1}),l||(n.WEBGL=!1),l&&n.WEBGL)return n.debug("Resize canvas with WebGL"),v(e,r,t,function(a){return a?(n.debug("WebGL resize failed, do fallback and cancel next attempts"),n.debug(a),l=!1,o(e,r,t,u)):void u()});n.debug("Resize canvas: prepare data"),f=r.getContext("2d"),s=f.createImageData(h,p);var g={src:e.getContext("2d").getImageData(0,0,c,d).data,dest:s.data,width:e.width,height:e.height,toWidth:r.width,toHeight:r.height,quality:t.quality,alpha:t.alpha,unsharpAmount:t.unsharpAmount,unsharpRadius:t.unsharpRadius,unsharpThreshold:t.unsharpThreshold,transferable:!0};return i(g,function(e){return e?void u(e):(f.putImageData(s,0,0),void u())})}var u="undefined"!=typeof window&&"Worker"in window;if(u)try{var f=e("webworkify")(function(){});f.terminate()}catch(s){u=!1}var c,l=!1;try{"undefined"!=typeof document&&"undefined"!=typeof window&&window.WebGLRenderingContext&&(c=document.createElement("canvas"),(c.getContext("webgl")||c.getContext("experimental-webgl"))&&(l=!0))}catch(s){}finally{c=null}var d=e("./lib/resize"),h=e("./lib/resize_worker"),v=e("./lib/resize_webgl");n.resizeBuffer=i,n.resizeCanvas=o,n.WW=u,n.WEBGL=!1,n.debug=function(){}},{"./lib/resize":3,"./lib/resize_webgl":4,"./lib/resize_worker":5,webworkify:7}]},{},[])("/")});
